\! bash sql/backup.sh
###### BACKUP COMMAND TEST-0001 ######
###### full backup mode ######
0
1
###### BACKUP COMMAND TEST-0002 ######
###### incremental backup mode ######
0
2
###### BACKUP COMMAND TEST-0003 ######
###### archive backup mode ######
0
3
###### BACKUP COMMAND TEST-0004 ######
###### full backup with server log ######
0
1
###### BACKUP COMMAND TEST-0005 ######
###### Make sure that pg_rman does not take a differential backup, but a incremental backup ######
0
CREATE TABLE
INSERT 0 1000000
0
0
INCR 16kB OK
###### BACKUP COMMAND TEST-0006 ######
###### full backup with compression ######
0
1
1
###### BACKUP COMMAND TEST-0007 ######
###### full backup with smooth checkpoint ######
0
1
###### BACKUP COMMAND TEST-0008 ######
###### switch backup mode from incremental to full ######
incremental backup without validated full backup
INFO: copying database files
ERROR: cannot take an incremental backup
DETAIL: There is no validated full backup with current timeline.
HINT: Please take a full backup and validate it before doing an incremental backup. Or use with --full-backup-on-error command line option.
10
incremental backup in the same situation but with --full-backup-on-error option
INFO: copying database files
NOTICE: turn to take a full backup
DETAIL: There is no validated full backup with current timeline.
INFO: copying archived WAL files
INFO: copying server log files
INFO: backup complete
INFO: Please execute 'pg_rman validate' to verify the files are correctly copied.
0
1
1
###### BACKUP COMMAND TEST-0009 ######
###### switch backup mode from archive to full ######
archive backup without validated full backup
ERROR: cannot take an incremental backup
DETAIL: There is no validated full backup with current timeline.
HINT: Please take a full backup and validate it before doing an archive backup. Or use with --full-backup-on-error command line option.
10
archive backup in the same situation but with --full-backup-on-error option
NOTICE: turn to take a full backup
DETAIL: There is no validated full backup with current timeline.
INFO: copying database files
INFO: copying archived WAL files
INFO: copying server log files
INFO: backup complete
INFO: Please execute 'pg_rman validate' to verify the files are correctly copied.
0
1
1
###### BACKUP COMMAND TEST-0010 ######
###### failure in backup with different system identifier database ######
ERROR: could not start backup
DETAIL: system identifier of target database is different from the one of initially configured database
10
